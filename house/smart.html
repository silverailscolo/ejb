<!DOCTYPE html> <html lang="nl"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="robots" content="noindex, nofollow, noarchive, nosnippet, notranslate, noimageindex"> <title> Smart Huis | EJB's site </title> <meta name="author" content="EJ Broerse"> <meta name="description" content="Informatieve site over mijn werk en hobby's. Geen garanties!"> <meta name="keywords" content="architecture, house, trains"> <link rel="stylesheet" href="/ejb/assets/css/bootstrap.min.css?59683d8d628e6717785b508ec539c429"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/ejb/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/ejb/assets/css/bootstrap-toc.min.css?771920573e5f7efee19e36fbd8b06c1f" rel="stylesheet"> <link rel="shortcut icon" href="/ejb/assets/img/favicon.png?7de88881c5eea3dd7fcff1b84ec5f1bf"> <link rel="stylesheet" href="/ejb/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://silverailscolo.github.io/ejb/house/smart"> <link defer rel="stylesheet" href="/ejb/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/ejb/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/ejb/"> <div><img src="/ejb/assets/img/favicon.png" alt="Broerse"></div> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/ejb/">over </a> </li> <li class="nav-item "> <a class="nav-link" href="/ejb/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/ejb/architect/">architectuur </a> </li> <li class="nav-item "> <a class="nav-link" href="/ejb/projects/">projecten </a> </li> <li class="nav-item "> <a class="nav-link" href="/ejb/gallery/">collecties </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">treinen </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/ejb/trains/layout">mijn modelbaan</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/rollingstock">het materieel</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/trains/dcc">DCC</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/trains/prototype">prototype</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/trains/tips">tips</a> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">huis </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/ejb/house/garden">tuin</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/house/renovation">renovatie</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/house/history">geschiedenis</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/house/smart">smart home</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/house/ms15">eerste huis</a> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">computers </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/ejb/computers/repositories">GitHub repositories</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/computers/mymacs">mijn Macs</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/computers/macintosh">Mac tips</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/computers/lubuntu">Lubuntu tips</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/ejb/computers/playground">speeltuin</a> </div> </li> <li class="nav-item active"> <a class="nav-link" href="/ejb/en-us/house/smart"> EN-US</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Smart Huis</h1> <p class="post-description"></p> </header> <article> <p>Automatisering in ons huis begon simpel: een paar Ikea lampen, 2 elektrisch bediende rolgordijnen. Een paar jaar later was het tijd om de verschillende systemen op elkaar aan te sluiten en centraal slim te bedienen.</p> <p><img src="/ejb/assets/img/house/smart/home-assistant-logo.svg" alt="Home Assistant logo"></p> <p>Ik heb een Raspberry Pi 4 met daarop <a href="https://www.home-assistant.io/" rel="external nofollow noopener" target="_blank">hassos</a> OS geïnstalleerd om alles te bedienen. De Pi verbruikt maar 4W, veel minder dan dat je het op een Mac of PC draait (iMac 24/7 with Oracle VirtualBox verbruikt 36 W = 312 kW/jaar).</p> <p><a href="https://www.home-assistant.io/" rel="external nofollow noopener" target="_blank">HomeAssistant</a> (HA) is een open source programma waarmee je zowel met de hand als automatisch verschillende systemen kan bedienen, en ze aan elkaar koppelen, zonder dat je aan een merk, abonnement of cloud service vastzit.</p> <p>Standaard integraties die ik gebruik:</p> <ul> <li> <a href="https://www.home-assistant.io/integrations/tradfri/" rel="external nofollow noopener" target="_blank">Ikea Tradfri</a> verlichting, slimme stopcontacten en een rolgordijn</li> <li> <a href="https://www.home-assistant.io/integrations/tuya/" rel="external nofollow noopener" target="_blank">Tuya Smart</a> Zigbee (ook voor OEM zoals Lidl)</li> <li> <a href="https://www.home-assistant.io/integrations/hunterdouglas_powerview/" rel="external nofollow noopener" target="_blank">PowerView</a> Hunter Douglas/Luxaflex vouwgordijnen en up-down</li> <li>SolarEdge PV omvormer</li> <li> <a href="https://www.home-assistant.io/integrations/tado/" rel="external nofollow noopener" target="_blank">Tado</a> slimme thermostaat en -knoppen</li> <li>Siemens/Bosch Home Connect (wasmachine meldingen)</li> <li>MyUplink, het huidige protocol voor onze Nibe F1255 warmtepomp</li> </ul> <p>Met HA Community Plug-ins kunnen gebruikers/ontwikkelaars zelf extra systemen in HA toevoegen. Je vindt ze op de “marktplaats” HACS (Home Assistant Community Store) of je kan ze zelfs handmatig kopiëren als custom repositories van GitHub in HACS, e.g.</p> <ul> <li>myenergi (Zappi EV laadpaal en energiemonitor)</li> <li>Gardena tuinsprinkler timers</li> <li>Casambi Bluetooth (werkt zonder Casambi API/server/gateway)</li> </ul> <p>HomeAssistant ondersteunt ook zgn. Add-Ons die extra functionaliteit op de Pi4 server bieden. Ik gebruik:</p> <ul> <li>File Editor (om configuratiebestandjes aan te passen in de iOS HomeAssistant Companion app )</li> <li>Advanced SSH &amp; Web Terminal</li> <li>Mosquito Broker (ontvangt en verstuurt MQTT berichten op het Wi-Fi netwerk)</li> <li>Samba NAS (voor toegang tot gedeelde mappen op de RPi)</li> <li>InfluxDB (om lange-termijngegevens over energieverbruik bij te houden)</li> </ul> <p>Met MQTT sluiten we onafhankelijke apparaten aan op HomeAssistant, zoals:</p> <ul> <li> <h2 id="nibepi-om-onze-nibe-f1255-warmtepomp-via-modbus-te-besturen-dit-draait-op-een-aparte-raspberry-pizero"> <a href="https://github.com/anerdins/nibepi" rel="external nofollow noopener" target="_blank">nibepi</a> (om onze Nibe F1255 warmtepomp via Modbus te besturen. Dit draait op een aparte Raspberry PiZero)</h2> </li> </ul> <h2 id="energiemonitoring">Energiemonitoring</h2> <p>Door de gegevens over ons energieverbruik te combineren met die van opwekking en de <a href="https://www.myenergi.com" rel="external nofollow noopener" target="_blank">myenergi</a> Zappi EV-laadpaal kan ik ons totale elektraverbruik splitsen en optimaliseren. Dankzij 2 extra CT-klemmen in de meterkast kreeg ik ook veel beter zicht op de grote elektrische apparaten zoals ons AGA-fornuis.</p> <p><img src="/ejb/assets/img/house/smart/ha_energydistr.png" alt="Home Assistant Energy Dashboard"></p> <h2 id="maatwerk-oplossingen">Maatwerk oplossingen</h2> <p>Ik heb programma’s geschreven voor microcontrollers om voor onze situatie precies zo te laten werken als we willen. Met MicroPython en ESPHome was dit vrij eenvoudig, want je kan tegenwoordig mooie modules kant-en-klaar bestellen voor € 10. Ik raad iedereen aan om dit ook te proberen, zowel voor de lol als om onafhankelijk van abonnementen en standaard producten te worden.</p> <div class="card mx-auto mb-3 p-3" style="max-width: 95%;"> <h3 id="oven">Slim Ovenpaneel</h3> <p>Ik ben een paar keer vergeten om de elektrische oven uit te zetten, omdat er geen opvallend waarschuwingslampje op de AGA Cooker zit. Elke keer gooide ik zo 1-2 kWh weg! Ik heb het opgelost door een Raspberry PicoW microcontroller met een 1.3" OLED-schermpje aan HomeAssistant te koppelen via MQTT/Wi-Fi. Zodra de sensor in de meterkast ziet dat de AGA aan staat, maakt een MQTT bericht het schermpje op het aanrecht wakker, en toont grafische welke kookplaat of ovens aan staan. Een timer toont hoelang hij nog moet opwarmen (kookplaat = 15 min, Een oven duurt 60 min.). Na afloop - als ik al lang in de tuin loop - krijg ik op mijn telefoon de melding "Oven is opgewarmd". En als hij langer dan 2 uur aan staat krijg ik de vraag op dat ook de bedoeling is. Energieverspilling onder controle!</p> <figure><img src="/ejb/assets/img/house/smart/aga/agadisplay_IMG9388.jpg" alt="AGA display in gebruik" class="img-fluid"><figcaption class="kleiner">Het schermpje naast het fornuis</figcaption></figure> <p>Zie <a href="/ejb/blog/2024/smartovendisplay">dit draadje</a> voor details.</p> </div> <div class="card mx-auto mb-3 p-3" style="max-width: 95%;"> <h3 id="fan">Slimme ventilator</h3> <p>Een energiezuinig huis vraagt om bewust regelen van de luchtverversing, want het tocht (gelukkig) niet. T veel ventilatie maakt het huis 's zomers te warm en te koud (condens) in de winter. Vertrouwen op natuurlijke ventilatie blijkt niet te werken als het niet waait of als het verkeerslawaai je uit je slaap houdt.<br> Met een slimme CO<sub>2</sub>-meter besturen we nu een energiezuinige EC-ventilator. Ik heb een kleine 25x25mm ESP32 Atom Lite controller geprogrammeerd om de CO<sub>2</sub>-waarde onder de 800 ppi te houden. De ventilator is ingebouwd in een kast buiten de slaapkamer, zodat je alleen de lucht hoort stromen - totdat je slaapt.</p> <figure><img src="/ejb/assets/img/house/smart/whisper/whisper_complete.jpg" alt="Ventilator in de kast" class="img-fluid"><figcaption class="kleiner">Slimme ventilator in bedrijf</figcaption></figure> <p>Zie <a href="/ejb/blog/2024/whisper-fan">dit draadje</a> voor details.</p> </div> <p>Als je een nieuw gadget koopt, let dan goed op de ondersteunde protocollen, bijv. HomeKit, Zigbee/Tuya, Matter of Thread. Ik zou geen OEM of gesloten bedrijfsprotocollen aanraden want dan krijg je voor elk apparaat een hub/gateway kastje er bij. Die staan altijd aan, en verbruiken elk weer een paar Watt.</p> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 EJ Broerse. <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.nl" rel="external nofollow noopener" target="_blank"><img decoding="async" loading="lazy" src="https://silverailscolo.github.io/ejb/assets/img/by-nc-sa.png" width="117" height="41" alt="CC BY-NC-SA 4.0" style="float: right;"></a> <br> Laatst bijgewerkt: 18 sep 2024 </div> </footer> <script src="/ejb/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/ejb/assets/js/masonry.js" type="text/javascript"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>